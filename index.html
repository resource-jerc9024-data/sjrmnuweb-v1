<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>SJR MUN Registration 2026 - Closed</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="handler/styles.css" />
  <!-- AOS (Animate On Scroll) for subtle motion -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css" />
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <style>
    .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);opacity:0;pointer-events:none;background:#0b1220;border:1px solid #1f2937;color:#e5e7eb;border-radius:12px;padding:12px 14px;box-shadow:0 20px 50px rgba(0,0,0,.5);display:flex;align-items:center;gap:12px;min-width:260px;z-index:1000;transition:.25s opacity,.25s transform}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0);pointer-events:auto}
    .toast.success{border-color:rgba(158,240,26,.5)}
    .toast.error{border-color:#7f1d1d}
    .toast.warning{border-color:rgba(245,158,11,.5)}
    .field.error input, .field.error select, .field.field-inline.error { border-color: #ef4444 !important; box-shadow: 0 0 0 2px rgba(239,68,68,0.2) !important; }
    .error-message { color: #ef4444; font-size: 12px; margin-top: 4px; display: none; }
    .field.error .error-message { display: block; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none !important; }

    /* Full-bleed banner */
    .banner-wrap{position:relative;left:50%;right:50%;margin-left:-50vw;margin-right:-50vw;width:100vw}
    .banner-wrap img{width:100%;height:auto;display:block}
    
    /* Custom styles for multiple select */
    .department-checkboxes {
      display: grid;
      gap: 10px;
      margin-top: 8px;
      max-height: 240px;
      overflow-y: auto;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--bg-lighter);
      position: relative;
    }
    
    /* Responsive grid layout */
    @media (min-width: 768px) {
      .department-checkboxes {
        grid-template-columns: repeat(2, 1fr);
        max-height: 240px;
      }
    }
    
    @media (min-width: 1024px) {
      .department-checkboxes {
        grid-template-columns: repeat(3, 1fr);
        max-height: 240px;
      }
    }
    
    @media (max-width: 767px) {
      .department-checkboxes {
        grid-template-columns: 1fr;
        max-height: 240px;
      }
    }
    
    /* iOS-style transparent scrollbar */
    .department-checkboxes::-webkit-scrollbar {
      width: 7px;
      height: 7px;
    }
    
    .department-checkboxes::-webkit-scrollbar-track {
      background: transparent;
      border-radius: 10px;
      margin: 4px 0;
    }
    
    .department-checkboxes::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      border: 2px solid transparent;
      background-clip: content-box;
      transition: background 0.3s ease;
    }
    
    .department-checkboxes::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.4);
      border: 2px solid transparent;
      background-clip: content-box;
    }
    
    .department-checkboxes::-webkit-scrollbar-corner {
      background: transparent;
    }
    
    /* Firefox scrollbar styling */
    .department-checkboxes {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
    }
    
    .department-checkbox {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 8px;
      transition: all 0.2s ease;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid transparent;
      min-height: 44px;
      box-sizing: border-box;
    }
    
    .department-checkbox:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.1);
      transform: translateY(-1px);
    }
    
    .department-checkbox:active {
      transform: translateY(0);
    }
    
    .department-checkbox input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      border-radius: 4px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: transparent;
      appearance: none;
      -webkit-appearance: none;
      transition: all 0.2s ease;
      position: relative;
      flex-shrink: 0;
    }
    
    .department-checkbox input[type="checkbox"]:checked {
      background: var(--primary);
      border-color: var(--primary);
    }
    
    .department-checkbox input[type="checkbox"]:checked::after {
      content: '✓';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 12px;
      font-weight: bold;
    }
    
    .department-checkbox input[type="checkbox"]:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(158, 240, 26, 0.3);
    }
    
    .department-checkbox span {
      font-size: 14px;
      line-height: 1.4;
      cursor: pointer;
      color: var(--text);
      flex: 1;
      word-break: break-word;
    }
    
    .selection-info {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
      display: block;
      opacity: 0.8;
    }
    
    .department-checkbox.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: none;
    }
    
    .department-checkbox.disabled:hover {
      background: rgba(255, 255, 255, 0.03);
      border-color: transparent;
      transform: none;
    }
    
    /* Selection counter */
    .selection-counter {
      position: absolute;
      top: -28px;
      right: 0;
      font-size: 11px;
      color: var(--text-secondary);
      background: rgba(255, 255, 255, 0.05);
      padding: 4px 10px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 3;
    }
    
    /* Fade effect at top and bottom for iOS-like scrolling */
    .department-checkboxes::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 20px;
      background: linear-gradient(to bottom, var(--bg-lighter) 0%, transparent 100%);
      pointer-events: none;
      z-index: 2;
      border-radius: 12px 12px 0 0;
    }
    
    .department-checkboxes::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 20px;
      background: linear-gradient(to top, var(--bg-lighter) 0%, transparent 100%);
      pointer-events: none;
      z-index: 2;
      border-radius: 0 0 12px 12px;
    }
    
    /* Make sure content is above the fade effect */
    .department-checkboxes > * {
      position: relative;
      z-index: 1;
    }
    
    /* Department field specific styling */
    .field[data-field-type="departments"] {
      position: relative;
    }
    
    /* Ensure proper spacing in the form grid */
    .field[data-field-type="departments"] {
      grid-column: span 2;
    }
    
    @media (max-width: 767px) {
      .field[data-field-type="departments"] {
        grid-column: span 1;
      }
    }
    
    /* Adjust for existing form grid layout */
    .form-wrap .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    
    @media (max-width: 767px) {
      .form-wrap .grid {
        grid-template-columns: 1fr;
      }
    }
    
    .form-wrap .grid .span-2 {
      grid-column: span 2;
    }
    
    @media (max-width: 767px) {
      .form-wrap .grid .span-2 {
        grid-column: span 1;
      }
    }
    
    /* Loading spinner */
    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
      vertical-align: middle;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* 2026 Closed Status Styles - Green Theme */
    .closed-badge {
      display: inline-block;
      background: linear-gradient(135deg, #9ef01a 0%, #70e000 100%);
      color: #0b1220;
      font-size: 0.9rem;
      font-weight: 700;
      padding: 4px 12px;
      border-radius: 20px;
      margin-left: 12px;
      vertical-align: middle;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 10px rgba(158, 240, 26, 0.3);
      text-transform: uppercase;
    }

    .closed-banner {
      background: linear-gradient(135deg, #0b1220 0%, #1a2a1a 100%);
      border-radius: 16px;
      padding: 32px 24px;
      margin: 20px 0 30px 0;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      border: 1px solid rgba(158, 240, 26, 0.2);
    }

    .closed-banner::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(158, 240, 26, 0.1) 0%, transparent 50%);
      animation: rotate 20s linear infinite;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .closed-banner h2 {
      font-size: 3.5rem;
      font-weight: 700;
      margin: 0 0 16px 0;
      color: #9ef01a;
      text-shadow: 0 2px 20px rgba(158, 240, 26, 0.3);
      letter-spacing: 2px;
      position: relative;
      z-index: 1;
    }

    .closed-banner p {
      font-size: 1.2rem;
      color: rgba(255, 255, 255, 0.9);
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }

    .closed-banner .date-highlight {
      background: rgba(158, 240, 26, 0.1);
      padding: 8px 24px;
      border-radius: 50px;
      display: inline-block;
      margin-top: 20px;
      font-weight: 600;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(158, 240, 26, 0.3);
      position: relative;
      z-index: 1;
      color: #9ef01a;
    }

    .form-overlay {
      position: relative;
      opacity: 0.7;
      pointer-events: none;
      filter: blur(2px);
      transition: all 0.3s ease;
    }

    .form-overlay:hover {
      opacity: 0.8;
      filter: blur(1px);
    }

    .closed-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(11, 18, 32, 0.95);
      border: 2px solid #9ef01a;
      border-radius: 20px;
      padding: 40px 60px;
      text-align: center;
      z-index: 10;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      backdrop-filter: blur(10px);
      min-width: 320px;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0% { transform: translate(-50%, -50%) translateY(0px); }
      50% { transform: translate(-50%, -50%) translateY(-10px); }
      100% { transform: translate(-50%, -50%) translateY(0px); }
    }

    .closed-message .year {
      font-size: 6rem;
      font-weight: 800;
      background: linear-gradient(135deg, #9ef01a 0%, #70e000 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1;
      margin-bottom: 10px;
      text-shadow: 0 0 30px rgba(158, 240, 26, 0.3);
    }

    .closed-message .status {
      font-size: 2rem;
      font-weight: 700;
      color: white;
      margin: 10px 0;
      letter-spacing: 2px;
    }

    .closed-message .subtext {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.1rem;
      margin: 15px 0;
    }

    .closed-message .next-year {
      background: linear-gradient(135deg, #9ef01a 0%, #70e000 100%);
      color: #0b1220;
      border: none;
      padding: 12px 30px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 700;
      margin-top: 20px;
      cursor: default;
      box-shadow: 0 4px 15px rgba(158, 240, 26, 0.4);
      text-transform: uppercase;
    }

    /* Ensure navigation buttons remain accessible */
    .footer-bar {
      position: relative;
      z-index: 20;
    }

    .social-btn {
      pointer-events: auto !important;
      position: relative;
      z-index: 100;
    }

    /* Update admin button colors to match green theme */
    .social-btn.admin {
      border-color: #9ef01a !important;
      color: #9ef01a !important;
    }

    /* Remove all hover effects from admin and formview buttons - static style */
    .social-btn.admin:hover,
    .social-btn.admin:focus,
    .social-btn.admin:active {
      background: transparent !important;
      border-color: #9ef01a !important;
      color: #9ef01a !important;
      transform: none !important;
      box-shadow: none !important;
      opacity: 1 !important;
      filter: none !important;
    }
    
    /* Ensure the regular social-btn (Instagram) keeps its hover (optional, but we keep static for both to match spec) */
    .social-btn:hover,
    .social-btn:focus,
    .social-btn:active {
      background: transparent !important;
      border-color: var(--border) !important;
      color: inherit !important;
      transform: none !important;
      box-shadow: none !important;
      opacity: 1 !important;
      filter: none !important;
    }

    /* Update primary button colors */
    .btn.primary {
      background: linear-gradient(135deg, #9ef01a 0%, #70e000 100%);
      color: #0b1220;
      font-weight: 700;
    }

    .btn.primary:disabled {
      background: linear-gradient(135deg, #4a6b1a 0%, #2a4a1a 100%);
      color: rgba(255, 255, 255, 0.5);
    }

    /* Update glow effect for title */
    .glow-title {
      text-shadow: 0 0 30px rgba(158, 240, 26, 0.3);
    }

    /* Update focus styles */
    .department-checkbox input[type="checkbox"]:focus {
      box-shadow: 0 0 0 2px rgba(158, 240, 26, 0.3);
    }

    /* Update selection counter border */
    .selection-counter {
      border-color: rgba(158, 240, 26, 0.2);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .closed-banner h2 {
        font-size: 2.5rem;
      }
      
      .closed-banner p {
        font-size: 1rem;
      }
      
      .closed-message {
        padding: 30px 40px;
        min-width: 280px;
      }
      
      .closed-message .year {
        font-size: 4rem;
      }
      
      .closed-message .status {
        font-size: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .closed-message {
        padding: 20px 30px;
        min-width: 240px;
      }
      
      .closed-message .year {
        font-size: 3rem;
      }
      
      .closed-message .status {
        font-size: 1.2rem;
      }
    }

    /* Update form field focus states */
    input:focus, select:focus {
      border-color: #9ef01a !important;
      box-shadow: 0 0 0 2px rgba(158, 240, 26, 0.2) !important;
    }

    /* Update radio button colors */
    input[type="radio"]:checked {
      background: #9ef01a;
      border-color: #9ef01a;
    }

    /* Update link colors */
    .credit-link {
      color: #9ef01a;
    }

    .credit-link:hover {
      color: #70e000;
    }
    
    /* Title stacking for phone: main title first line, badge second line */
    @media (max-width: 600px) {
      .hero .title {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      .hero .title .closed-badge {
        margin-left: 0; /* remove left margin when stacked */
      }
    }
  </style>
</head>
<body>
  <main class="page">
    <!-- Full-bleed Banner -->
    <section class="scroll-section" id="hero" data-aos="fade-up" data-aos-delay="60">
      <div class="banner-wrap" aria-label="Hero banner">
        <picture>
          <source media="(max-width: 640px)" srcset="images/banner.gif" />
          <img src="images/banner.png" alt="SJR MUN Banner" />
        </picture>
      </div>
    </section>

    <header class="hero" data-aos="fade-down">
      <h1 class="title glow-title" data-aos="zoom-in">
        SJR MUN REGISTRATION FORM
        <span class="closed-badge">2026 Registrations Closed</span>
      </h1>
    </header>

    <!-- 2026 Closed Banner - Green Theme -->
    <section data-aos="fade-up" data-aos-delay="90">
      <div class="closed-banner">
        <h2>2026</h2>
        <p>Thank you for your overwhelming response! Registrations for SJR MUN 2026 have successfully concluded.</p>
        <div class="date-highlight">
          <span>✨ Stay tuned for SJR MUN 2027 ✨</span>
        </div>
      </div>
    </section>

    <section class="form-wrap" data-aos="fade-up" data-aos-delay="120" style="position: relative;">
      <!-- Closed overlay message with green theme -->
      <div class="closed-message">
        <div class="year">2026</div>
        <div class="status">REGISTRATIONS<br>CLOSED</div>
        <div class="subtext">Thank you for your interest!</div>
        <div class="next-year">See you in 2027</div>
      </div>

      <h2 class="section-title">CANDIDATE DETAILS</h2>
      <form id="registrationForm" class="form form-overlay" novalidate>
        <div class="grid">
          <label class="field">
            <span>Full Name <span style="color:#ef4444">*</span></span>
            <input type="text" name="full_name" placeholder="Full Name" autocomplete="name" required disabled />
            <div class="error-message">Please enter your full name</div>
          </label>

          <label class="field">
            <span>Father's Name <span style="color:#ef4444">*</span></span>
            <input type="text" name="father_name" placeholder="Father's Name" autocomplete="additional-name" required disabled />
            <div class="error-message">Please enter your father's name</div>
          </label>

          <label class="field">
            <span>Mother's Name <span style="color:#ef4444">*</span></span>
            <input type="text" name="mother_name" placeholder="Mother's Name" autocomplete="additional-name" required disabled />
            <div class="error-message">Please enter your mother's name</div>
          </label>

          <label class="field">
            <span>Aadhar Number <span style="color:#ef4444">*</span></span>
            <input type="text" name="aadhar_number" placeholder="12-digit Aadhar Number" autocomplete="off" 
                   inputmode="numeric" maxlength="14" required disabled />
            <div class="error-message">Please enter a 12-digit Aadhar number</div>
          </label>

          <fieldset class="field field-inline" id="genderField">
            <legend>Gender <span style="color:#ef4444">*</span></legend>
            <label class="radio"><input type="radio" name="gender" value="Male" required disabled /> <span>Male</span></label>
            <label class="radio"><input type="radio" name="gender" value="Female" required disabled /> <span>Female</span></label>
            <label class="radio"><input type="radio" name="gender" value="Other" required disabled /> <span>Other</span></label>
            <div class="error-message">Please select your gender</div>
          </fieldset>

          <label class="field">
            <span>Date of Birth <span style="color:#ef4444">*</span></span>
            <input type="date" name="dob" autocomplete="bday" required disabled />
            <div class="error-message">Please select your date of birth</div>
          </label>

          <label class="field span-2">
            <span>Institution / School / College name <span style="color:#ef4444">*</span></span>
            <input type="text" name="institute" placeholder="Institution / School / College" autocomplete="organization" required disabled />
            <div class="error-message">Please enter your institution name</div>
          </label>

          <label class="field">
            <span>Class <span style="color:#ef4444">*</span></span>
            <select name="class" autocomplete="education-level" required disabled>
              <option value="" selected disabled>Select</option>
              <option>6</option>
              <option>7</option>
              <option>8</option>
              <option>9</option>
              <option>10</option>
              <option>11</option>
              <option>12</option>
            </select>
            <div class="error-message">Please select your class</div>
          </label>

          <label class="field">
            <span>Phone No. <span style="color:#ef4444">*</span></span>
            <input type="tel" name="phone" inputmode="numeric" placeholder="Enter your phone No" autocomplete="tel" required pattern="[0-9]{10}" disabled />
            <div class="error-message">Please enter a valid 10-digit phone number</div>
          </label>

          <label class="field">
            <span>Email <span style="color:#ef4444">*</span></span>
            <input type="email" name="email" placeholder="Enter your Email" autocomplete="email" required disabled />
            <div class="error-message">Please enter a valid email address</div>
          </label>

          <label class="field span-2">
            <span>Address <span style="color:#ef4444">*</span></span>
            <input type="text" name="address" placeholder="Address" autocomplete="street-address" required disabled />
            <div class="error-message">Please enter your address</div>
          </label>

          <label class="field">
            <span>Landmark</span>
            <input type="text" name="landmark" placeholder="Landmark (Optional)" autocomplete="landmark" disabled />
            <div class="error-message" style="display:none"></div>
          </label>

          <label class="field">
            <span>City <span style="color:#ef4444">*</span></span>
            <input type="text" name="city" placeholder="City" autocomplete="address-level2" required disabled />
            <div class="error-message">Please enter your city</div>
          </label>

          <label class="field span-2" data-field-type="departments">
            <span>Department <span class="selection-info">(Select up to 2 departments)</span></span>
            <div class="department-checkboxes" id="departmentCheckboxes">
              <!-- Checkboxes will be generated by JavaScript -->
            </div>
            <input type="hidden" name="department" id="departmentInput" required />
            <div class="error-message">Please select at least one department (max 2)</div>
          </label>
        </div>

        <p class="slogan">"TOGETHER - STRONGER - HIGHER"</p>
        <div class="actions">
          <button type="reset" class="btn ghost" id="resetBtn" disabled>Reset</button>
          <button type="submit" class="btn primary" id="submitBtn" disabled>Submit</button>
        </div>
      </form>
      <p class="issued">Issued by :SJR MUN CLUB</p>
    </section>

    <footer class="footer">
      <small>Designed for SJR MUN CLUB</small>
      <br />
      <span class="footer-credits">Website by <strong><a class="credit-link" href="https://works.onpratiks.com" target="_blank" rel="noopener noreferrer">Pratik</a></strong> &copy; <span id="currentYear"></span></span>
      <div class="footer-bar">
        <div class="left">
          <a class="social-btn" href="https://www.instagram.com/sjrmun" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" focusable="false">
              <path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5a5.5 5.5 0 1 1 0 11 5.5 5.5 0 0 1 0-11zm0 2a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7zm5.75-.75a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0z"/>
            </svg>
            <span>Instagram</span>
          </a>
        </div>
        <div class="right" style="display:flex; gap:12px; align-items:center;">
          <!-- Form View button removed as requested -->
          <!-- Admin Panel button removed as requested -->
        </div>
      </div>
    </footer>
  </main>

  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>AOS.init({ once:true, duration:700, easing:'ease-out-cubic' });</script>
  <script src="handler/script.js"></script>
  
  <!-- Form Validation & Toast functionality -->
  <script>
    // Function to format name fields with proper capitalization
    function formatNameField(input) {
      if (!input || !input.value) return;
      
      let value = input.value.trim();
      
      // Split by spaces and capitalize each word
      value = value.split(/\s+/)
        .map(word => {
          // Handle empty words
          if (!word) return '';
          
          // Capitalize first letter, lowercase the rest
          return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
        })
        .join(' ');
      
      // Update the input value
      input.value = value;
    }

    // Function to format institution/school/college names
    function formatInstituteName(input) {
      if (!input || !input.value) return;
      
      let value = input.value.trim();
      
      // Handle common abbreviations and special cases
      const specialWords = {
        'and': 'and',
        'of': 'of',
        'the': 'the',
        'in': 'in',
        'for': 'for',
        'at': 'at',
        'by': 'by',
        'with': 'with',
        'on': 'on',
        'to': 'to',
        'a': 'a',
        'an': 'an',
        'or': 'or',
        '&': '&'
      };
      
      // Split by spaces and format each word
      value = value.split(/\s+/)
        .map((word, index) => {
          // Handle empty words
          if (!word) return '';
          
          // Check if it's a special word (not first word)
          const lowerWord = word.toLowerCase();
          if (index > 0 && specialWords[lowerWord]) {
            return specialWords[lowerWord];
          }
          
          // Handle acronyms (words that are all caps or contain dots)
          if (word === word.toUpperCase() || word.includes('.')) {
            return word;
          }
          
          // Capitalize first letter, lowercase the rest
          return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
        })
        .join(' ');
      
      // Update the input value
      input.value = value;
    }

    // Format Aadhar number with spaces (XXXX XXXX XXXX)
    function formatAadharNumber(input) {
      if (!input || !input.value) return;
      
      let value = input.value.replace(/\D/g, ''); // Remove non-digits
      
      // Format as XXXX XXXX XXXX
      if (value.length > 0) {
        value = value.match(/.{1,4}/g).join(' ');
      }
      
      // Limit to 12 digits (plus 2 spaces)
      if (value.length > 14) {
        value = value.substring(0, 14);
      }
      
      input.value = value;
    }

    // Department management functions
    function initializeDepartmentCheckboxes() {
      const departments = [
        'Delegates Affairs',
        'Logistics',
        'Hospitality',
        'Sponsorship',
        'Outreach',
        'Social Media',
        'Designing',
        'Researcher',
        'Academia Ambassador',
        'Organising Team',
        'Editor',
        'Tech Department',
        'Graphic Designer',
        'Marketing Team',
        'Camera Crew'
      ];
      
      const container = document.getElementById('departmentCheckboxes');
      const hiddenInput = document.getElementById('departmentInput');
      const field = hiddenInput.closest('.field');
      
      // Clear container
      container.innerHTML = '';
      
      // Create checkbox for each department
      departments.forEach(dept => {
        const label = document.createElement('label');
        label.className = 'department-checkbox';
        label.innerHTML = `
          <input type="checkbox" value="${dept}" disabled />
          <span>${dept}</span>
        `;
        
        container.appendChild(label);
      });
      
      // Add selection counter element
      const counter = document.createElement('div');
      counter.className = 'selection-counter';
      counter.id = 'selectionCounter';
      counter.style.opacity = '0';
      counter.textContent = '0/2 selected';
      field.appendChild(counter);
      
      // Disable all checkboxes since form is closed
      const checkboxes = container.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach(checkbox => {
        checkbox.disabled = true;
        checkbox.closest('.department-checkbox').classList.add('disabled');
      });
    }

    // Form validation utility
    (function(){
      function ensureToast(){
        let el = document.getElementById('popup');
        if (!el) {
          el = document.createElement('div');
          el.id = 'popup';
          el.className = 'toast';
          el.innerHTML = '<span id="popupText"></span><button id="popupClose" class="btn ghost">Close</button>';
          document.body.appendChild(el);
          const close = el.querySelector('#popupClose');
          close.addEventListener('click', () => { el.classList.remove('show','success','error','warning'); });
        }
        return el;
      }
      
      window.showToast = function(msg, kind='success'){
        const el = ensureToast();
        const text = el.querySelector('#popupText');
        if (text) text.textContent = msg;
        el.classList.remove('success','error','warning');
        el.classList.add('show', kind);
        clearTimeout(el.__hideT);
        el.__hideT = setTimeout(() => el.classList.remove('show','success','error','warning'), 6000);
      };
      
      window.showSiteError = function(msg){
        window.showToast(msg || 'An error occurred', 'error');
      };
      
      window.showWarning = function(msg){
        window.showToast(msg, 'warning');
      };

      // Form validation functions
      window.validateForm = function(form) {
        return false; // Form is closed
      };

      // Real-time validation
      window.setupRealTimeValidation = function(form) {
        // Initialize department checkboxes
        initializeDepartmentCheckboxes();
        
        // Add disabled attribute to all form elements
        const inputs = form.querySelectorAll('input, select, button');
        inputs.forEach(input => {
          input.disabled = true;
        });
        
        // Disable radio buttons
        const radios = form.querySelectorAll('input[type="radio"]');
        radios.forEach(radio => {
          radio.disabled = true;
        });
      };

      function validateField(field) {
        // No validation needed as form is disabled
        return;
      }
    })();
  </script>

  <!-- Firebase config loader -->
  <script>
    window.loadFirebaseConfig = async function loadFirebaseConfig(){
      try {
        if (window.FIREBASE_API_KEY && window.FIREBASE_PROJECT_ID) {
          console.log('Firebase config already loaded');
          return true;
        }
        console.log('Loading Firebase config from /api/env...');
        const res = await fetch('/api/env');
        if (!res.ok) {
          throw new Error(`HTTP ${res.status}: ${await res.text()}`);
        }
        const cfg = await res.json();
        console.log('Received config from API:', cfg);
        if (!cfg.FIREBASE_API_KEY || !cfg.FIREBASE_PROJECT_ID) {
          throw new Error('Missing required Firebase configuration from API');
        }
        window.FIREBASE_API_KEY = cfg.FIREBASE_API_KEY;
        window.FIREBASE_AUTH_DOMAIN = cfg.FIREBASE_AUTH_DOMAIN;
        window.FIREBASE_PROJECT_ID = cfg.FIREBASE_PROJECT_ID;
        window.FIREBASE_STORAGE_BUCKET = cfg.FIREBASE_STORAGE_BUCKET;
        window.FIREBASE_MESSAGING_SENDER_ID = cfg.FIREBASE_MESSAGING_SENDER_ID;
        window.FIREBASE_APP_ID = cfg.FIREBASE_APP_ID;
        console.log('Firebase config loaded successfully');
        return true;
      } catch (err) {
        console.error('Failed to load Firebase config:', err);
        window.showSiteError('Application configuration error: ' + (err && err.message ? err.message : 'Failed to fetch'));
        return false;
      }
    }
  </script>

  <!-- Firebase environment setup -->
  <script>
    window.env = {
      FIREBASE_API_KEY: window.FIREBASE_API_KEY || "",
      FIREBASE_AUTH_DOMAIN: window.FIREBASE_AUTH_DOMAIN || "",
      FIREBASE_PROJECT_ID: window.FIREBASE_PROJECT_ID || "",
      FIREBASE_STORAGE_BUCKET: window.FIREBASE_STORAGE_BUCKET || "",
      FIREBASE_MESSAGING_SENDER_ID: window.FIREBASE_MESSAGING_SENDER_ID || "",
      FIREBASE_APP_ID: window.FIREBASE_APP_ID || ""
    };
  </script>

  <!-- Current year for footer -->
  <script>
    document.getElementById('currentYear').textContent = new Date().getFullYear();
  </script>

  <!-- Main Firebase application - USING FIRESTORE LITE (NO EVAL) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore-lite.js";

    (async () => {
      try {
        const ok = await window.loadFirebaseConfig();
        if (!ok) throw new Error('Firebase configuration failed to load');

        const cfg = {
          apiKey: window.FIREBASE_API_KEY,
          authDomain: window.FIREBASE_AUTH_DOMAIN,
          projectId: window.FIREBASE_PROJECT_ID,
          storageBucket: window.FIREBASE_STORAGE_BUCKET,
          messagingSenderId: window.FIREBASE_MESSAGING_SENDER_ID,
          appId: window.FIREBASE_APP_ID,
        };

        if (!cfg.apiKey || !cfg.projectId) {
          const error = 'Missing Firebase config. Check Vercel environment variables.';
          console.error(error);
          window.showSiteError(error);
          throw new Error(error);
        }

        let app, db;
        try {
          app = initializeApp(cfg);
          db = getFirestore(app);
          console.log('Firestore Lite initialized successfully');
        } catch (error) {
          console.error('Firebase initialization error:', error);
          window.showSiteError('Firebase initialization failed: ' + (error && error.message ? error.message : 'Unknown error'));
          throw error;
        }

        const form = document.getElementById('registrationForm');
        const submitBtn = document.getElementById('submitBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        // Setup real-time validation (which will disable all form elements)
        window.setupRealTimeValidation(form);

        const toast = (() => {
          let el = document.getElementById('popup');
          if (!el) {
            el = document.createElement('div');
            el.id = 'popup';
            el.className = 'toast';
            el.innerHTML = '<span id="popupText"></span><button id="popupClose" class="btn ghost">Close</button>';
            document.body.appendChild(el);
          }
          const text = el.querySelector('#popupText');
          const close = el.querySelector('#popupClose');
          let hideT;
          close.addEventListener('click', () => { el.classList.remove('show','success','error','warning'); });
          return {
            show(msg, kind='success'){
              if (text) text.textContent = msg;
              el.classList.remove('success','error','warning');
              el.classList.add('show', kind);
              clearTimeout(hideT);
              hideT = setTimeout(() => el.classList.remove('show','success','error','warning'), 6000);
            }
          };
        })();

        // Form submission handler - disabled
        form?.addEventListener('submit', async (e) => {
          e.preventDefault();
          window.showWarning('Registrations for 2026 are closed. Thank you for your interest!');
        });

        // Reset button handler
        resetBtn?.addEventListener('click', (e) => {
          e.preventDefault();
          window.showWarning('Registrations are closed. Form cannot be reset.');
        });

        // Show a toast message on page load
        setTimeout(() => {
          window.showWarning('SJR MUN 2026 Registrations are now closed. Thank you for your support!');
        }, 1000);

      } catch (error) {
        console.error('Critical error in module:', error);
        window.showSiteError('Application failed to initialize. Please refresh the page.');
      }
    })();
  </script>
</body>
</html>
